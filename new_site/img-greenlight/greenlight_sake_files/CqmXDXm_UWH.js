if (self.CavalryLogger) { CavalryLogger.start_js(["oHjPy"]); }

__d('MAnimation',['CSS','MLegacyDataStore','getVendorPrefixedName','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h,i,j,k){var l=j('animation-duration');function m(n,o,p){var q=i.get(n);clearTimeout(q.timerEnd);delete q.timerEnd;h.conditionClass(n,o,false);h.conditionClass(n,'accelerate',true);n.style[l]=p+'ms';q.timerStart=k(h.conditionClass.bind(null,n,o,true),0);q.timerEnd=k(function(){h.conditionClass.bind(null,n,o,false);n.style[l]='';h.conditionClass(n,'accelerate',false);var r=i.get(n);clearTimeout(r.timerStart);delete r.timerStart;},p);}f.exports={animate:m};}),null);
__d('MExpandablePymk',['setTimeoutAcrossTransitions','CSS','DOM','MLegacyDataStore','cx'],(function a(b,c,d,e,f,g,h,i,j,k,l){var m='m-add-friend';function n(p,q,r){var s=[],t=0;if(p){var u=j.scry(p,'div','story-wrap');for(var v=0;v<u.length;v++){var w=j.find(u[v],'a',m),x=k.get(w);s.push(x.id);var y=k.get(u[v]);if(y.sent)t++;}r.pymk_group_id=q;}if(s)r.uw=s.join(',');if(t)r.pc=t;return s;}function o(p,event,q){if(!p)return;var r=p.getElementsByClassName("_4-ck");if(r.length>0)h(function(){p.style.height="";},800);var s=function aa(ba){return function(){i.conditionClass(ba,"_4-cl",true);};},t=function aa(ba){return function(){i.conditionClass(ba,"_4-ck",false);};},u=j.scry(p,'div','story-wrap'),v=0;for(var w=0;w<u.length;w++){var x=k.get(u[w]);if(x.transitionIn){k.set(u[w],{transitionIn:false});h(s(u[w]),800);h(t(u[w]),1200);}else if(x.sent){var y=u[w];if(r.length>0)p.style.height=(p.offsetHeight-r.length*r[0].offsetHeight).toString()+'px';i.conditionClass(y,"_4-cn",true);if(q){i.conditionClass(y,"_4-co",true);i.conditionClass(y,"_4-cp",false);}h(function(){j.remove(y);},600);v++;}}if(v<u.length){var z=event.getNode('story-wrap');k.set(z,{sent:true});if(q){i.conditionClass(z,"_4-cp",true);i.conditionClass(z,"_4-co",false);}}}f.exports={getExtraArgs:n,animateExpansion:o};}),null);
__d('MFriendingState',[],(function a(b,c,d,e,f,g){f.exports={REQUEST_SENT:'m:friending-state:request-sent',REQUEST_CANCELED:'m:friending-state:request-canceled',UNFRIENDED:'m:friending-state:unfriended'};}),null);
__d('MAddFriend',['DOM','MLegacyDataStore','Stratcom','MAnimation','MExpandablePymk','MFriendingState','MPageCache','MPageControllerPath','MPymkFunnelLogger','MRequest','MRequestTypes','MURI','MFriendingActionError','Parent','csx','cx'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x='m-add-friend',y='m-cancel-request',z='m-unfriend-request',aa='m-unfollow-request',ba='m-follow-request',ca='check',da='friends',ea='add_friend_pymk_chain_placeholder',fa='/a/mobile/friends/add_friend.php',ga='/a/friendrequest/cancel/index.php',ha='/a/friends/remove',ia='/a/subscriptions/remove',ja='/a/subscriptions/add',ka=86,la='/find-friends/index.php',ma='mobile_jewel';function na(ya){var za=ya.querySelector('.touched_hide');za&&k.animate(za,"_4-ic",500);}function oa(){var ya=o.getRequestPath();n.removeCachedPage(ya);n.clearCachedIUIResponses(ya);}function pa(event){var ya=event.getNode(x),za=i.get(ya),ab=event.getNode('m-add-friend-secondary'),bb=i.get(ab),cb=za.pymk_group_id||'pymk_suggestions_box',db=event.getNode('id:'+cb),eb=document.getElementById(ea);va(event);i.set(ab,{one_click_adding:true,one_click_cancel_event:null});oa();var fb={id:za.id,hf:za.hf,sc:za.sc,so:za.so,pl:za.pl,at:za.at,et:za.et,ed:za.ed,fref:za.fref};if(za.floc)fb.floc=za.floc;if(za.frefs)fb.frefs=za.frefs;if(za.el)fb.el=za.el;var gb=l.getExtraArgs(db,cb,fb),hb=h.find(ab,'*',ca),ib=h.find(ab,'div','m-add-friend-flyout'),jb=new s(fa);if(za.searchlog)jb.addQueryData(za.searchlog);var kb=new s(ya.href).getQueryData()._ft_;if(kb)jb.addQueryData({_ft_:kb});var lb=new s(ya.href).getQueryData().__xt__;if(lb)jb.addQueryData({__xt__:lb});var mb=new q(jb.toString()).setType(r.DEPENDENT);mb.setData(fb);var nb=function ob(){h.show(hb);i.get(ab).bounce&&na(hb);j.listen('friending_state_change',null,qa.bind(event,fb.id,t.SEND_OUTGOING_REQUEST_ERROR));j.invoke(m.REQUEST_SENT,null,{event:event,userid:fb.id});};mb.listen('start',function(){h.hide(ib);nb();});mb.listen('postprocess',function(ob){if(bb.one_click_adding){i.set(ab,{one_click_adding:false});if(bb.one_click_cancel_event)sa(bb.one_click_cancel_event);}if(gb)l.animateExpansion(db,event,eb);});mb.send();event.kill();}function qa(ya,za,event){var ab=event.getData();if(ab.userid!=ya)return;if(ab.error!=za)return;var bb=this.getNode('m-add-friend-secondary');if(ab.error===t.SEND_OUTGOING_REQUEST_ERROR){var cb=h.find(bb,'*',ca),db=h.find(bb,'div','m-add-friend-flyout');h.show(db);h.hide(cb);j.invoke(t.SEND_OUTGOING_REQUEST_ERROR,null,{event:this});}else if(ab.error===t.CANCEL_OUTGOING_REQUEST_ERROR){var eb=h.find(bb,'a','m-cancel-request'),fb=h.find(bb,'div','m-add-friend-flyout');h.show(eb);h.hide(fb);j.invoke(t.CANCEL_OUTGOING_REQUEST_ERROR,null,{event:this});}j.removeCurrentListener();}function ra(ya){var za=i.get(ya.getNode(z)),event=za.flyoutEvent,ab=event.getNode('undoable-action');if(!ab)ab=event.getNode('m-add-friend-secondary');var bb=h.scry(ab,'*',da)[0],cb=h.find(ab,'div','m-add-friend-flyout'),db=new s(ha),eb=new q(db);eb.setData({friend_id:za.id,noReload:true,unref:za.unfriend_ref});eb.listen('start',function(){h.hide(bb);if(!za.is_deactivated)h.show(cb);j.invoke(m.UNFRIENDED,null,{event:event});});eb.send();event.kill();}function sa(event){var ya=i.get(event.getNode(y)),za=event.getNode('undoable-action');if(!za)za=event.getNode('m-add-friend-secondary');if(!za)za=ya.parentNode;var ab=h.scry(za,'*',ca)[0],bb=h.find(za,'*','load'),cb=h.find(za,'div','m-add-friend-flyout'),db=event.getNode('m-add-friend-secondary'),eb=db?i.get(db):null;if(eb&&eb.one_click_adding){i.set(db,{one_click_cancel_event:event});h.hide(ab);h.show(bb);return;}var fb=function ib(){h.show(cb);j.invoke(m.REQUEST_CANCELED,null,{event:event,userid:ya.id});},gb=new s(ga),hb=new q(gb);hb.setData({subject_id:ya.id,ref_param:ya.ref_param,floc:ya.floc,frefs:ya.frefs});j.listen('friending_state_change',null,qa.bind(event,ya.id,t.CANCEL_OUTGOING_REQUEST_ERROR));hb.listen('start',function(){h.hide(ab);h.show(bb);});hb.listen('finally',function(){h.hide(bb);fb();var ib=event.getNode('story-wrap');if(ib)i.set(ib,{sent:false});});hb.send();event.kill();}function ta(event){var ya=event.getNode(aa),za=i.get(ya),ab=new s(ia),bb=new q(ab);bb.setData({subject_id:za.id,forceredirect:false,location:ka});bb.send();event=za.flyoutEvent;var cb=event.getNode('popup-action-trigger');i.set(cb,{is_following:false});event.kill();}function ua(event){var ya=event.getNode(ba),za=i.get(ya),ab=new s(ja),bb=new q(ab);bb.setData({subject_id:za.id,forceredirect:false,location:ka});bb.send();event=za.flyoutEvent;var cb=event.getNode('popup-action-trigger');i.set(cb,{is_following:true});event.kill();}function va(event){var ya=event.getNode(x);if(!ya)return;var za=u.bySelector(ya,"._5pxa");if(!za)return;var ab=za.getAttribute('data-pymk-id'),bb=za.getAttribute('data-pymk-loc');if(ab&&(bb===la||bb===ma)){var cb=za.getAttribute('data-signature');p.logAdd(ab,cb,bb);}}var wa=false,xa=function ya(za){if(wa)return;wa=true;j.listen('click',x,pa);j.listen('click',y,sa);j.listen('click',z,ra);if(typeof za!=='undefined'&&za){j.listen('click',aa,ta);j.listen('click',ba,ua);}};f.exports={main:xa};}),null);
__d('MAddFriendNew',['MFriendingState','DOM','Stratcom'],(function a(b,c,d,e,f,g,h,i,j){var k='m-add-friend-flyout',l='m-cancel-request';function m(n,o,p){'use strict';this.unit=p;this.userid=o;j.listen(h.REQUEST_SENT,null,this.onFriendRequestSent.bind(this));j.listen(h.REQUEST_CANCELED,null,this.onFriendRequestCanceled.bind(this));}m.prototype.onFriendRequestCanceled=function(event){'use strict';var n=event.getData();if(!n||n.userid!==this.userid)return;var o=i.scry(this.unit,'*',k)[0],p=i.scry(this.unit,'*',l)[0];i.show(o);i.hide(p);};m.prototype.onFriendRequestSent=function(event){'use strict';var n=event.getData();if(!n||n.userid!==this.userid)return;var o=i.scry(this.unit,'*',k)[0],p=i.scry(this.unit,'*',l)[0];i.hide(o);i.show(p);};f.exports=m;}),null);
__d('MFriendDynamicSubtitle',['DOM','MAnimation','MFriendingState','MFriendingActionError','Stratcom','cx','MParent'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n){var o='undoable-action',p='m-add-friend-request-sent',q='m-friend-request-canceled',r='m-friend-unfriended',s='m-add-friend-source-replaceable',t='m-friend-request-highlight-notice';function u(v,w){'use strict';this.$MFriendDynamicSubtitle1=v;this.$MFriendDynamicSubtitle2=w;this.$MFriendDynamicSubtitle3=n.bySigil(v,o);this.$MFriendDynamicSubtitle4=[l.listen([k.SEND_OUTGOING_REQUEST_ERROR,k.CANCEL_OUTGOING_REQUEST_ERROR,j.REQUEST_SENT,j.REQUEST_CANCELED,j.UNFRIENDED],null,this.$MFriendDynamicSubtitle5.bind(this)),l.listen('m:page:unload',null,this.$MFriendDynamicSubtitle6.bind(this)),l.listen('friending_state_change',null,this.$MFriendDynamicSubtitle7.bind(this))];}u.prototype.$MFriendDynamicSubtitle7=function(v){'use strict';var w=v.getData();if(!w||!w.userid||w.userid!=this.$MFriendDynamicSubtitle2)return;if(!w.error)return;this.$MFriendDynamicSubtitle8(w.error);};u.prototype.$MFriendDynamicSubtitle5=function(v){'use strict';var w=v.getData();if(!w||!w.userid||w.userid!=this.$MFriendDynamicSubtitle2)return;var x=v.getType();this.$MFriendDynamicSubtitle8(x);};u.prototype.$MFriendDynamicSubtitle8=function(v){'use strict';this.$MFriendDynamicSubtitle9();if(v===j.REQUEST_SENT||v===k.CANCEL_OUTGOING_REQUEST_ERROR){this.$MFriendDynamicSubtitle10(p);}else if(v===j.REQUEST_CANCELED){this.$MFriendDynamicSubtitle10(q);}else if(v===j.UNFRIENDED){this.$MFriendDynamicSubtitle10(r);}else if(v===k.SEND_OUTGOING_REQUEST_ERROR)this.$MFriendDynamicSubtitle10(s);this.$MFriendDynamicSubtitle11();};u.prototype.$MFriendDynamicSubtitle9=function(){'use strict';this.$MFriendDynamicSubtitle12(p);this.$MFriendDynamicSubtitle12(s);this.$MFriendDynamicSubtitle12(q);this.$MFriendDynamicSubtitle12(r);};u.prototype.$MFriendDynamicSubtitle12=function(v){'use strict';var w=h.scry(this.$MFriendDynamicSubtitle3,'*',v)[0];w&&h.hide(w);};u.prototype.$MFriendDynamicSubtitle10=function(v){'use strict';var w=h.scry(this.$MFriendDynamicSubtitle3,'*',v)[0];w&&h.show(w);};u.prototype.$MFriendDynamicSubtitle11=function(){'use strict';var v=h.scry(this.$MFriendDynamicSubtitle3,'*',t)[0];if(v)i.animate(v,"_4z0z",4000);};u.prototype.$MFriendDynamicSubtitle6=function(){'use strict';for(var v=0;v<this.$MFriendDynamicSubtitle4.length;v++)this.$MFriendDynamicSubtitle4[v].remove();};f.exports=u;}),null);
__d('MFriendsActionBubble',['MLegacyDataStore','DOM','Stratcom','MURI'],(function a(b,c,d,e,f,g,h,i,j,k){var l='m-unfriend-request',m='/friendlists/edit',n='manage-friend-list',o='m-follow-request',p='m-unfollow-request';function q(r){'use strict';this.$MFriendsActionBubble1=r;this.$MFriendsActionBubble2=null;}q.prototype.enable=function(){'use strict';this.$MFriendsActionBubble2=[j.listen('click','are-friends-popup',this.$MFriendsActionBubble3.bind(this)),j.listen('click',n,this.$MFriendsActionBubble4.bind(this))];};q.prototype.$MFriendsActionBubble3=function(r){'use strict';var s=this.$MFriendsActionBubble1.getContentRoot(),t=r.getNode('popup-action-trigger'),u=i.scry(s,'*',l)[0];this.$MFriendsActionBubble5(t,u,r);var v=i.scry(s,'*',n)[0];this.$MFriendsActionBubble5(t,v,r);this.$MFriendsActionBubble6(t,s,r);};q.prototype.$MFriendsActionBubble6=function(r,s,t){'use strict';var u=h.get(r).is_following;if(u===null)return;var v=i.scry(s,'*',p)[0];this.$MFriendsActionBubble5(r,v,t);var w=i.scry(s,'*',o)[0];this.$MFriendsActionBubble5(r,w,t);if(u){i.show(v);i.hide(w);}else{i.show(w);i.hide(v);}};q.prototype.$MFriendsActionBubble5=function(r,s,t){'use strict';if(!r||!s)return;var u=h.get(r);u.flyoutEvent=t;h.set(s,u);};q.prototype.$MFriendsActionBubble7=function(r,event){'use strict';if(window.FW_ENABLED||!window.APP_ENABLED){event.kill();window.location.href=r.toString();}else j.invoke('go',null,{uri:r});};q.prototype.$MFriendsActionBubble4=function(event){'use strict';var r=h.get(event.getNode(n)),s=new k(m).setQueryData({subject_id:r.id,ref_param:r.manage_list_ref});this.$MFriendsActionBubble7(s,event);};q.prototype.disable=function(){'use strict';while(this.$MFriendsActionBubble2.length)this.$MFriendsActionBubble2.pop().remove();};f.exports=q;}),null);
__d('MOptimisticRequestResponse',['DOM','MLegacyDataStore','MRequest','Stratcom','MURI'],(function a(b,c,d,e,f,g,h,i,j,k,l){function m(event){var q,r;if(r=event.getNode('ignore-request')){q='ignore';}else if(r=event.getNode('confirm-request')){q='confirm';}else throw new Error('use ignore-request or confirm-request sigils for actions');var s=i.get(r);if(!s||!s.optimistic_uri)throw new Error('add meta to buttons with optimistic_uri set');if(s.flyoutEvent)event=s.flyoutEvent;var t=n(event),u=i.get(t),v=u.optimistic_category;if(!v)throw new Error('set optimistic_category meta on root node '+'to separate listeners for optimistic responses');var w=h.scry(t,'*','m-optimistic-response-action'),x=h.scry(t,'*','m-optimistic-response-confirm'),y=h.scry(t,'*','m-optimistic-response-ignore'),z=new j(new l(s.optimistic_uri)).setData(s.optimistic_post_data||{}).setMethod('POST'),aa={event:event,action:q,action_sections:w,confirm_sections:x,ignore_sections:y,root_node:t};z.listen('start',function(){k.invoke('m:requests:refresh');k.invoke('m:optimistic-request-response:click',v,aa);if(u.userid)k.invoke('friending_state_change',null,{userid:u.userid,action:q});});z.listen('postprocess',function(){k.invoke('m:requests:refresh');k.invoke('m:optimistic-request-response:success',v,aa);});z.listen('error',function(){p(w);o(x);o(y);});z.send();}function n(event){var q=event.getNode('m-optimistic-response-root');if(!q)throw new Error('no parent element with m-optimistic-response-root sigil');return q;}function o(q){q.forEach(function(r){h.hide(r);});}function p(q){q.forEach(function(r){h.show(r);});}k.listen('click','confirm-request',m);k.listen('click','ignore-request',m);f.exports={showAll:p,hideAll:o};}),null);
__d('MOptimisticFriendingResponse',['DOM','Stratcom','MOptimisticRequestResponse','MFriendingActionError'],(function a(b,c,d,e,f,g,h,i,j,k){function l(m,n,o){'use strict';this.id=m;this.userid=n;this.inJewel=o;this.listeners=[i.listen('friending_state_change',null,this.onFriendStateChange.bind(this)),i.listen('m:page:unload',null,this.cleanup.bind(this))];}l.prototype.onFriendStateChange=function(m){'use strict';var n=m.getData();if(n.userid!=this.userid)return;var o=document.getElementById(this.id);if(!o)return;var p=h.scry(o,'*','m-optimistic-response-action'),q=h.scry(o,'*','m-optimistic-response-confirm'),r=h.scry(o,'*','m-optimistic-response-ignore');switch(n.error){case k.CONFIRM_INCOMING_REQUEST_ERROR:case k.DELETE_INCOMING_REQUEST_ERROR:j.showAll(p);j.hideAll(r);j.hideAll(q);return;}j.hideAll(p);switch(n.action){case 'confirm':j.showAll(q);j.hideAll(r);break;case 'ignore':case 'reject':j.showAll(r);j.hideAll(q);break;default:return;}};l.prototype.cleanup=function(){'use strict';if(this.inJewel)return;for(var m=0;m<this.listeners.length;m++)this.listeners[m].remove();this.listeners=[];};f.exports=l;}),null);
__d('MLayerHideOnScroll',['Stratcom'],(function a(b,c,d,e,f,g,h){var i=5;function j(k){'use strict';this.$MLayerHideOnScroll1=null;this.$MLayerHideOnScroll2=null;this.$MLayerHideOnScroll3=k;this.$MLayerHideOnScroll4=null;}j.prototype.enable=function(){'use strict';this.$MLayerHideOnScroll1=[this.$MLayerHideOnScroll3.addListener('show',this.$MLayerHideOnScroll5.bind(this)),this.$MLayerHideOnScroll3.addListener('hide',this.$MLayerHideOnScroll6.bind(this))];if(this.$MLayerHideOnScroll3.isShown())this.$MLayerHideOnScroll5();};j.prototype.disable=function(){'use strict';this.$MLayerHideOnScroll6();while(this.$MLayerHideOnScroll1.length)this.$MLayerHideOnScroll1.pop().remove();this.$MLayerHideOnScroll1=null;};j.prototype.$MLayerHideOnScroll6=function(){'use strict';this.$MLayerHideOnScroll2&&this.$MLayerHideOnScroll2.remove();};j.prototype.$MLayerHideOnScroll5=function(){'use strict';var k=window;this.$MLayerHideOnScroll4=k.scrollY;this.$MLayerHideOnScroll2=h.listen('scroll',null,function(){var l=k.scrollY;if(Math.abs(this.$MLayerHideOnScroll4-l)>=i)this.$MLayerHideOnScroll3.hide();}.bind(this));};f.exports=j;}),null);